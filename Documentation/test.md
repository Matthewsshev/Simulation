# `csv_test.py` - CSV Regression Test and Verification

The Python script `csv_test.py` serves as a critical quality assurance tool designed specifically to verify the integrity and correctness of CSV files generated by the conversion script, `convert-simsqlite2csv2.py`.

### Purpose of the Test

The primary objective of `csv_test.py` is to function as a regression test. Its main purpose is to rigorously check for any errors or unintended changes introduced to the CSV output *after* modifications have been made to the database-to-CSV conversion script (`convert-simsqlite2csv2.py`).

By comparing a newly generated CSV file (`modular_test.csv`) against a known, verified baseline (`test_changes.csv`), the script ensures that the conversion process consistently produces the expected results.

### How the Script Works

The script operates through the following steps:

1.  **Reading and Normalization (`read_csv`):**
    * The `read_csv` function reads the CSV files and processes the data.
    * Crucially, it converts each row into a sorted tuple of key-value pairs. This normalization ensures that the comparison is independent of the column order in the CSV files.

2.  **Comparison (`compare_files`):**
    * The `compare_files` function reads both the new file and the baseline file using `read_csv`.
    * It then performs a direct comparison of the normalized data structures.

3.  **Verification (`main`):**
    * The `main` function executes the comparison.
    * If the contents of `modular_test.csv` and `test_changes.csv` are identical, the test passes, indicating the conversion script is working correctly and no errors were introduced.
    * If the files differ, the test fails (`Some tests failed ‚ùå`), signaling that the conversion process has produced unexpected results, likely due to a regression in the `convert-simsqlite2csv2.py` script.